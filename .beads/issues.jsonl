{"id":"worktree-v2-10","title":"Resume by branch name: allow resume command to find worktrees by branch name in addition to registry name, for cases where the worktree exists but isn't in the registry","description":"The resume command currently only looks up worktrees by registry name. If a worktree exists on disk but isn't in the registry (e.g., created manually or registry corrupted), resume fails.\n\n**Enhancement:**\n- First check registry by name\n- If not found, scan ~/.claude-worktrees/ for matching branch name\n- Also check git worktree list output for the branch\n\nAcceptance criteria:\n- [ ] resume works with registry name (existing behavior)\n- [ ] resume works with branch name when not in registry\n- [ ] Helpful error if branch not found anywhere","status":"open","priority":2,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-10T00:47:04.516782678Z","created_by":"Brendan Whitney","updated_at":"2026-02-10T07:16:49.803537-07:00","dependencies":[{"issue_id":"worktree-v2-10","depends_on_id":"worktree-v2-22","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-10","depends_on_id":"worktree-v2-22","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-11","title":"Smart cleanup: check for merged PRs and dirty local branches as cleanup qualifications, not just missing worktree paths","description":"Current cleanup only checks if worktree path exists. Should also check:\n\n**Cleanup qualifications:**\n1. Path doesn't exist (current)\n2. Branch has merged PR (safe to delete)\n3. Branch is stale (no commits in X days)\n4. Branch tracking remote that no longer exists\n\n**Safety checks before cleanup:**\n- Warn if local branch has uncommitted changes\n- Warn if local branch has unpushed commits\n- Require --force to delete branches with local-only work\n\nAcceptance criteria:\n- [ ] Checks for merged PRs via gh CLI\n- [ ] Checks for stale branches\n- [ ] Warns on dirty/unpushed branches\n- [ ] --force overrides safety checks","status":"open","priority":2,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-10T00:47:05.386949387Z","created_by":"Brendan Whitney","updated_at":"2026-02-10T07:17:00.659615-07:00","dependencies":[{"issue_id":"worktree-v2-11","depends_on_id":"worktree-v2-22","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-11","depends_on_id":"worktree-v2-22","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-12","title":"Separate container preparation step: planner should emit prepare_container instead of reusing prepare_sandbox when target is container","description":"The planner currently reuses prepare_sandbox step for container target. This is semantically incorrect - containers and sandboxes have different preparation.\n\n**Changes:**\n- Add StepType.PREPARE_CONTAINER to models\n- Planner emits PREPARE_CONTAINER when target='container'\n- Planner emits PREPARE_SANDBOX when target='sandbox'\n- Keep prepare_sandbox for backwards compatibility\n\n**Container vs Sandbox differences:**\n- Container: docker run with volume mounts\n- Sandbox: docker sandbox create with workspace isolation\n\nAcceptance criteria:\n- [ ] StepType.PREPARE_CONTAINER exists\n- [ ] Planner uses correct step type per target\n- [ ] Tests cover both container and sandbox paths","status":"open","priority":2,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-10T00:47:07.031029304Z","created_by":"Brendan Whitney","updated_at":"2026-02-10T07:17:08.720313-07:00","dependencies":[{"issue_id":"worktree-v2-12","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-13","title":"Implement StepHandler to wire backends to executor","description":"The CLI currently only does dry-run. Need a StepHandler implementation that:\n\n**Purpose:**\nConnect the Executor to real backends so workflows actually execute.\n\n**Implementation:**\n- StepHandler class takes a Backends container\n- Implements handler protocol expected by Executor\n- Translates WorkflowStep commands to backend calls:\n  - CLONE_REPO → git.clone_for_sandbox()\n  - PREPARE_SANDBOX → docker.create_sandbox()\n  - CONFIGURE_AUTH → auth.configure_gh()\n  - SPAWN_AGENT → terminal.spawn_terminal()\n  - etc.\n\n**Error handling:**\n- Catch backend exceptions\n- Update step status to FAILED\n- Propagate error details for debugging\n\nAcceptance criteria:\n- [ ] StepHandler class implements handler protocol\n- [ ] All StepTypes mapped to backend operations\n- [ ] Executor.run() with StepHandler executes real operations\n- [ ] Error handling propagates failures properly\n- [ ] Tests cover success and failure paths","status":"closed","priority":1,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-10T07:17:19.329828-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-10T07:23:18.541055-07:00","closed_at":"2026-02-10T07:23:18.541055-07:00","close_reason":"Replaced by epic worktree-v2-16 with subtasks 17-21"}
{"id":"worktree-v2-14","title":"Add --verbose/--quiet flags for output control","description":"Add output verbosity control to worktree.py CLI.\n\n**Flags:**\n- --verbose (-v): Show detailed progress, backend commands, timing info\n- --quiet (-q): Suppress non-error output, only show errors and final result\n\n**Behavior:**\n- Default: Normal output (progress indicators, summary)\n- Verbose: Add command details, timing, debug info\n- Quiet: Only errors and final status\n\n**Implementation:**\n- Add flags to typer app\n- Pass verbosity level through to backends\n- DryRun backends respect verbosity for output\n\nAcceptance criteria:\n- [ ] --verbose shows detailed execution info\n- [ ] --quiet suppresses non-essential output  \n- [ ] Flags work with all subcommands\n- [ ] Tests verify output levels","status":"open","priority":3,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-10T07:17:28.141824-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-10T07:17:28.141824-07:00","dependencies":[{"issue_id":"worktree-v2-14","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-15","title":"Add pyproject.toml console_scripts entry point","description":"Slash commands reference 'python scripts/cli/worktree.py'. Add proper entry point.\n\n**Change in pyproject.toml:**\n```toml\n[project.scripts]\nworktree-v2 = \"cli.worktree:app\"\n```\n\n**Benefits:**\n- Cleaner invocation: 'uv run worktree-v2 run ...'\n- Standard Python packaging practice\n- Easier integration with other tools\n\n**Updates needed:**\n- pyproject.toml console_scripts\n- All slash command .md files to use entry point\n- Documentation\n\nAcceptance criteria:\n- [ ] Entry point defined in pyproject.toml\n- [ ] 'uv run worktree-v2 --help' works\n- [ ] Slash commands updated\n- [ ] Tests still pass","status":"open","priority":4,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-10T07:17:37.810427-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-10T07:17:37.810427-07:00","dependencies":[{"issue_id":"worktree-v2-15","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-16","title":"Epic: Step Execution","description":"Wire the backends to the executor so workflows actually execute instead of just dry-run.\n\nThis is the critical missing piece - the StepHandler that translates WorkflowSteps into real backend operations.\n\n**Goal:** Run 'worktree run autonomous sandbox --task ...' and have it actually:\n- Clone the repo\n- Create the sandbox\n- Configure auth\n- Spawn the agent\n\n**Children:**\n- StepHandler protocol/interface\n- Git step implementations\n- Docker step implementations\n- Auth step implementations  \n- Terminal step implementations\n- Integration and wiring","status":"closed","priority":1,"issue_type":"epic","owner":"brendan.whitney@faraday.io","created_at":"2026-02-10T07:22:15.970754-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-10T17:45:49.162605386Z","closed_at":"2026-02-10T17:45:49.162605386Z","close_reason":"Step Execution epic complete: RealStepHandler, all handlers, CLI wiring, 31 tests"}
{"id":"worktree-v2-17","title":"StepHandler protocol and base implementation","description":"Define the StepHandler protocol that Executor uses to execute steps.\n\n**Protocol:**\n```python\nclass StepHandler(Protocol):\n    def execute(self, step: WorkflowStep, context: ExecutionContext) -\u003e StepResult:\n        '''Execute a single workflow step.'''\n        ...\n```\n\n**ExecutionContext contains:**\n- Backends container\n- Workflow state\n- Checkpoint manager\n- Logger/output\n\n**StepResult contains:**\n- success: bool\n- error: str | None\n- outputs: dict (for passing data between steps)\n\n**Base implementation:**\n- RealStepHandler dispatches to backend methods based on StepType\n- Uses match/case or dict dispatch\n\nAcceptance criteria:\n- [ ] StepHandler protocol defined\n- [ ] ExecutionContext dataclass defined\n- [ ] StepResult dataclass defined\n- [ ] Base dispatcher implementation\n- [ ] Tests with MockBackends","status":"closed","priority":1,"issue_type":"task","assignee":"Brendan Whitney","owner":"brendan.whitney@faraday.io","created_at":"2026-02-10T07:22:24.293334-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-10T17:45:54.080410097Z","closed_at":"2026-02-10T17:45:54.080410097Z","close_reason":"StepHandler protocol, ExecutionContext, RealStepHandler dispatch","dependencies":[{"issue_id":"worktree-v2-17","depends_on_id":"worktree-v2-16","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-18","title":"Git step handlers (clone, worktree)","description":"Implement step handlers for git operations.\n\n**Steps to handle:**\n- CLONE_REPO: Call git.clone_for_sandbox() or git.run_git('clone')\n- CREATE_WORKTREE: Call git.create_worktree()\n- FETCH_UPDATES: Call git.fetch_and_update()\n\n**Implementation:**\n- Map StepType to GitBackend method\n- Extract parameters from step.parameters\n- Call backend method\n- Return StepResult with success/error\n\nAcceptance criteria:\n- [ ] CLONE_REPO handler works\n- [ ] CREATE_WORKTREE handler works\n- [ ] FETCH_UPDATES handler works\n- [ ] Error cases return proper StepResult\n- [ ] Tests cover all git steps","status":"closed","priority":1,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-10T07:22:31.183078-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-10T17:45:54.161468389Z","closed_at":"2026-02-10T17:45:54.161468389Z","close_reason":"Git step handlers (validate_repo, create_worktree)","dependencies":[{"issue_id":"worktree-v2-18","depends_on_id":"worktree-v2-16","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-19","title":"Docker step handlers (sandbox, container)","description":"Implement step handlers for Docker operations.\n\n**Steps to handle:**\n- PREPARE_SANDBOX: Create docker sandbox with workspace mount\n- PREPARE_CONTAINER: Create regular docker container\n- BUILD_TEMPLATE: Build custom template image if needed\n\n**Implementation:**\n- PREPARE_SANDBOX → docker.create_sandbox() or docker sandbox create\n- PREPARE_CONTAINER → docker.run_container() \n- BUILD_TEMPLATE → docker.build_template_image()\n\nAcceptance criteria:\n- [ ] PREPARE_SANDBOX handler works\n- [ ] PREPARE_CONTAINER handler works  \n- [ ] BUILD_TEMPLATE handler works\n- [ ] Sandbox reuse detection works\n- [ ] Tests cover all docker steps","status":"closed","priority":1,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-10T07:22:37.030767-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-10T17:45:54.239674931Z","closed_at":"2026-02-10T17:45:54.239674931Z","close_reason":"Docker step handler (prepare_sandbox)","dependencies":[{"issue_id":"worktree-v2-19","depends_on_id":"worktree-v2-16","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-20","title":"Auth and terminal step handlers","description":"Implement step handlers for auth and terminal operations.\n\n**Auth steps:**\n- CONFIGURE_AUTH: Set up gh CLI authentication in sandbox/container\n- Uses scoped token from ralph-token\n\n**Terminal steps:**\n- SPAWN_AGENT: Open terminal and start Claude agent\n- Uses terminal.spawn_terminal() or equivalent\n\n**Implementation:**\n- CONFIGURE_AUTH → auth.configure_gh() with token\n- SPAWN_AGENT → terminal.spawn_terminal() with command\n\nAcceptance criteria:\n- [ ] CONFIGURE_AUTH handler works\n- [ ] SPAWN_AGENT handler works\n- [ ] Token passed securely\n- [ ] Terminal spawns correctly\n- [ ] Tests cover auth and terminal steps","status":"closed","priority":1,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-10T07:22:45.009664-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-10T17:45:54.314480014Z","closed_at":"2026-02-10T17:45:54.314480014Z","close_reason":"Auth and terminal handlers (authenticate, initialize_state, start_agent)","dependencies":[{"issue_id":"worktree-v2-20","depends_on_id":"worktree-v2-16","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-21","title":"Wire StepHandler into CLI and Executor","description":"Connect all the pieces so the CLI can run real workflows.\n\n**Changes:**\n- Executor accepts StepHandler in constructor\n- CLI creates RealStepHandler with real backends\n- CLI passes StepHandler to Executor\n- Remove --dry-run-only limitation\n\n**Flow:**\nCLI → create_backends(REAL) → RealStepHandler(backends) → Executor(handler) → run()\n\n**Testing:**\n- Integration test with MockBackends\n- Manual test with real Docker\n\nAcceptance criteria:\n- [ ] Executor uses StepHandler\n- [ ] CLI creates and passes StepHandler\n- [ ] End-to-end workflow executes\n- [ ] Dry-run still works (uses DryRunStepHandler)\n- [ ] Integration tests pass","status":"closed","priority":1,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-10T07:22:55.325919-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-10T17:45:54.387342681Z","closed_at":"2026-02-10T17:45:54.387342681Z","close_reason":"RealStepHandler wired into CLI and Executor","dependencies":[{"issue_id":"worktree-v2-21","depends_on_id":"worktree-v2-16","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-21","depends_on_id":"worktree-v2-17","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-21","depends_on_id":"worktree-v2-18","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-21","depends_on_id":"worktree-v2-19","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-21","depends_on_id":"worktree-v2-20","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-22","title":"Epic: V1 Feature Parity","description":"Ensure worktree-v2 has all functionality from worktree V1.\n\n**V1 features to verify/implement:**\n\nCleanup:\n- PR state checking (merged, closed) ✗ (task 11)\n- Dirty worktree detection\n- Registry cleanup for missing paths\n- --dry-run, --force, --all flags\n\nResume:\n- Branch name lookup ✗ (task 10)\n- Auto-create worktree for existing branch\n- Stale branch detection\n- Auto-merge main into stale branches\n\nToken management:\n- ralph-token CLI (add, update, remove, status)\n\nOther:\n- update-pr.py functionality\n- Sandbox reuse detection\n- Template caching\n\n**Goal:** Run V2 in place of V1 with no missing capabilities.","status":"open","priority":2,"issue_type":"epic","owner":"brendan.whitney@faraday.io","created_at":"2026-02-10T07:27:25.676099-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-10T07:27:25.676099-07:00","labels":["phase:polish"],"dependencies":[{"issue_id":"worktree-v2-22","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-23","title":"Auto-create worktree for existing branch on resume","description":"V1 resume creates a worktree automatically if the branch exists but no worktree does.\n\n**Current V2 behavior:** Fails if worktree not in registry\n\n**Expected V1 behavior:**\n1. Check if branch exists in repo\n2. If yes and no worktree, create one\n3. Continue with resume\n\n**Implementation:**\n- In resume command, after registry lookup fails\n- Check git branch -a for the branch\n- If found, create worktree at standard location\n- Register it and continue\n\nAcceptance criteria:\n- [ ] Resume works with just branch name (no registry entry)\n- [ ] Worktree created at ~/.claude-worktrees/\u003crepo\u003e/\u003cbranch\u003e\n- [ ] New worktree registered automatically","status":"open","priority":2,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-10T07:27:40.418729-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-10T07:27:40.418729-07:00","dependencies":[{"issue_id":"worktree-v2-23","depends_on_id":"worktree-v2-22","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-23","depends_on_id":"worktree-v2-22","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-24","title":"Auto-merge main into stale branches on resume","description":"V1 resume detects stale branches (\u003e7 days old) and offers to merge main.\n\n**Current V2 behavior:** No staleness detection\n\n**Expected V1 behavior:**\n1. Check branch age (days since last commit)\n2. If \u003e7 days, warn user\n3. Attempt to merge main into branch\n4. If conflicts, abort and warn\n\n**Implementation:**\n- Add get_branch_age_days() to GitBackend\n- In resume command, check age\n- Call merge_main_into_branch() if stale\n- Handle merge conflicts gracefully\n\nAcceptance criteria:\n- [ ] Stale branch detection works (configurable threshold)\n- [ ] Auto-merge offered for stale branches\n- [ ] Merge conflicts handled gracefully\n- [ ] User can skip merge with --no-merge flag","status":"open","priority":2,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-10T07:27:49.567168-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-10T07:27:49.567168-07:00","dependencies":[{"issue_id":"worktree-v2-24","depends_on_id":"worktree-v2-22","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-24","depends_on_id":"worktree-v2-22","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-25","title":"ralph-token CLI for scoped GitHub token management","description":"V1 has ralph-token CLI for managing scoped GitHub tokens per repository.\n\n**Commands:**\n- ralph-token add \u003cowner/repo\u003e - Store token for a repo\n- ralph-token update \u003cowner/repo\u003e - Update existing token\n- ralph-token remove \u003cowner/repo\u003e - Remove token\n- ralph-token status - Show all tokens with expiry\n\n**Storage:**\n- Tokens stored in ~/.claude/ralph-tokens.json\n- Encrypted or plaintext (check V1 implementation)\n\n**Usage:**\n- Ralph spawn checks for scoped token before using default GH_TOKEN\n- Scoped tokens enable fine-grained access per repo\n\nAcceptance criteria:\n- [ ] All four commands work\n- [ ] Tokens stored securely\n- [ ] Expiry tracking works\n- [ ] Integration with spawn workflow","status":"open","priority":2,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-10T07:28:03.367604-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-10T07:28:03.367604-07:00","dependencies":[{"issue_id":"worktree-v2-25","depends_on_id":"worktree-v2-22","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-25","depends_on_id":"worktree-v2-22","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-26","title":"Epic: Task Source Abstraction","description":"Implement a TaskSource protocol that allows worktree-v2 to accept tasks from multiple sources (beads, markdown, spec-kit, single task string). The orchestrator should be agnostic about how tasks were created - it only cares about executing them.\n\n## Design Decisions\n- TaskSource is a Protocol with get_tasks() and update_status() methods\n- Each source type has its own adapter implementation\n- Auto-detection checks sources in order: beads → spec-kit → markdown → prompt\n- Beads is the native/first-class source with full status sync\n- Other sources provide read + status update (e.g., checkbox toggle in markdown)\n\n## References\n- Design conversation: spec-kit analysis and architecture discussion\n- Unix philosophy: do one thing well, accept standard interfaces","status":"closed","priority":1,"issue_type":"epic","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:17:29.141905-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-13T07:01:19.992457218Z","closed_at":"2026-02-13T07:01:19.992457218Z","close_reason":"Epic complete: TaskSource ABC, BeadsSource, MarkdownSource, SingleTaskSource, auto-detection. 68 tests. PR #9.","labels":["phase:sources"],"dependencies":[{"issue_id":"worktree-v2-26","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-27","title":"TaskSource protocol and Task model","description":"Define the TaskSource protocol and unified Task model that all adapters will use.\n\n```python\nclass Task:\n    id: str\n    description: str\n    status: Status  # pending, in_progress, completed\n    dependencies: list[str]  # IDs of tasks this depends on\n    labels: dict[str, str]  # story, phase, parallel marker, etc.\n    source_ref: str  # Original reference (bead ID, line number, etc.)\n\nclass TaskSource(Protocol):\n    def get_tasks(self) -\u003e list[Task]: ...\n    def get_ready_tasks(self) -\u003e list[Task]: ...  # No unmet dependencies\n    def update_status(self, task_id: str, status: Status) -\u003e None: ...\n    def claim_task(self, task_id: str, agent_id: str) -\u003e bool: ...\n```\n\nLocation: scripts/orchestrator/task_source.py","status":"closed","priority":1,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:17:36.986758-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-13T07:01:16.055540175Z","closed_at":"2026-02-13T07:01:16.055540175Z","close_reason":"Implemented TaskSource ABC with get_tasks(), get_ready_tasks(), update_status(), claim_task(). Task dataclass and TaskStatus enum.","dependencies":[{"issue_id":"worktree-v2-27","depends_on_id":"worktree-v2-26","type":"blocked-by","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-27","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-27","depends_on_id":"worktree-v2-26","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-28","title":"BeadsSource adapter implementation","description":"Implement BeadsSource - the native, first-class task source.\n\nFeatures:\n- Calls `bd ready --json` to get available tasks\n- Full status sync via `bd update` and `bd close`\n- Supports claiming via `bd update --claim`\n- Maps bead fields to Task model (labels, deps, etc.)\n\nThis is the recommended source for production use.\n\nLocation: scripts/orchestrator/sources/beads.py","status":"closed","priority":1,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:17:42.766719-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-13T07:01:16.584555467Z","closed_at":"2026-02-13T07:01:16.584555467Z","close_reason":"Implemented BeadsSource adapter wrapping bd CLI with can_handle() checking .beads/issues.jsonl.","dependencies":[{"issue_id":"worktree-v2-28","depends_on_id":"worktree-v2-27","type":"blocked-by","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-28","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-28","depends_on_id":"worktree-v2-26","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-29","title":"MarkdownSource adapter implementation","description":"Implement MarkdownSource - parse a generic markdown task list.\n\nFeatures:\n- Parse `- [ ] Task description` format\n- Extract task IDs if present (e.g., [T001])\n- Status update toggles checkbox: `- [ ]` → `- [x]`\n- Infer dependencies from ordering/indentation\n\nSupports both simple lists and structured formats.\n\nLocation: scripts/orchestrator/sources/markdown.py","status":"closed","priority":1,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:17:45.616643-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-13T07:01:17.2710133Z","closed_at":"2026-02-13T07:01:17.2710133Z","close_reason":"Implemented MarkdownSource parsing checklist format with nested deps and checkbox toggle.","dependencies":[{"issue_id":"worktree-v2-29","depends_on_id":"worktree-v2-27","type":"blocked-by","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-29","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-29","depends_on_id":"worktree-v2-26","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-30","title":"SpecKitSource adapter implementation","description":"Implement SpecKitSource - parse spec-kit's tasks.md format.\n\nFeatures:\n- Detect spec-kit format: `- [ ] [T001] [P] [US1] Description`\n- Parse parallel markers [P] → no sibling dependencies\n- Parse story labels [USN] → group by user story\n- Parse phase structure (Setup, Foundation, Stories, Polish)\n- Map to Task model with proper dependency graph\n\nOnly enabled if spec-kit structure detected in repo.\n\nLocation: scripts/orchestrator/sources/speckit.py","status":"open","priority":2,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:17:49.089605-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-11T10:17:49.089605-07:00","dependencies":[{"issue_id":"worktree-v2-30","depends_on_id":"worktree-v2-27","type":"blocked-by","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-30","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-31","title":"SingleTaskSource adapter implementation","description":"Implement SingleTaskSource - the simplest case for ad-hoc tasks.\n\nFeatures:\n- Takes a single task string\n- Returns one Task with generated ID\n- Status update is no-op (ephemeral)\n- Used for: `worktree run --task 'fix the login bug'`\n\nLocation: scripts/orchestrator/sources/single.py","status":"closed","priority":1,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:17:51.429111-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-13T07:01:17.851189592Z","closed_at":"2026-02-13T07:01:17.851189592Z","close_reason":"Implemented SingleTaskSource wrapping a single task string as ephemeral fallback.","dependencies":[{"issue_id":"worktree-v2-31","depends_on_id":"worktree-v2-27","type":"blocked-by","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-31","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-31","depends_on_id":"worktree-v2-26","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-32","title":"TaskSource auto-detection logic","description":"Implement auto-detection that finds the appropriate TaskSource.\n\nDetection order:\n1. Beads: Check if `.beads/` exists and `bd ready` returns tasks\n2. Spec-kit: Check for `.specify/specs/*/tasks.md` with spec-kit format\n3. Markdown: Check for `tasks.md` or `TODO.md` in repo root\n4. Prompt: Fall back to asking user for task description\n\nCLI flag: `--from auto` (default) or explicit `--from beads|markdown|speckit`\n\nLocation: scripts/orchestrator/sources/__init__.py","status":"closed","priority":1,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:17:55.489736-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-13T07:01:19.862889176Z","closed_at":"2026-02-13T07:01:19.862889176Z","close_reason":"Implemented detect_source() with registry pattern. SpecKitSource (worktree-v2-30) is out of scope.","dependencies":[{"issue_id":"worktree-v2-32","depends_on_id":"worktree-v2-28","type":"blocked-by","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-32","depends_on_id":"worktree-v2-29","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-32","depends_on_id":"worktree-v2-30","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-32","depends_on_id":"worktree-v2-31","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-32","depends_on_id":"worktree-v2-26","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-33","title":"Epic: Execution Strategy","description":"Implement ExecutionStrategy that decides HOW to run tasks based on task characteristics and repo context.\n\n## Design Decisions\n- Worktree-v2 owns execution decisions, not planning\n- Decisions: interactive vs autonomous, local vs container vs sandbox, parallelism level\n- Strategy is based on: task complexity, risk level, repo requirements, task dependencies\n- User can override with CLI flags\n\n## Decision Factors\n1. Task complexity → affects mode (interactive for complex)\n2. Destructive operations → forces interactive mode\n3. Repo has Dockerfile/devcontainer → suggests isolation\n4. Repo needs secrets/auth → suggests sandbox (persistent auth)\n5. Independent task groups → enables parallelism\n\n## References\n- Design conversation: worktree-v2 as execution engine, agnostic about planning","status":"closed","priority":1,"issue_type":"epic","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:18:03.87007-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-12T20:33:25.102184752Z","closed_at":"2026-02-12T20:33:25.102184752Z","close_reason":"All subtasks complete: ExecutionStrategy, RepoInfo, mode/target/parallelism logic. PR #8.","labels":["phase:strategy"],"dependencies":[{"issue_id":"worktree-v2-33","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-34","title":"ExecutionDecision and ExecutionStrategy models","description":"Define the data models for execution decisions.\n\n```python\n@dataclass\nclass ExecutionDecision:\n    mode: Literal['interactive', 'autonomous']\n    target: Literal['local', 'container', 'sandbox']\n    parallelism: int  # Max concurrent agents\n    reasoning: str  # Human-readable explanation\n    task_groups: list[list[Task]]  # How tasks are grouped for parallel execution\n\nclass ExecutionStrategy:\n    def decide(self, tasks: list[Task], repo: RepoInfo) -\u003e ExecutionDecision: ...\n    def explain(self, decision: ExecutionDecision) -\u003e str: ...\n```\n\nLocation: scripts/orchestrator/strategy.py","status":"closed","priority":1,"issue_type":"task","assignee":"Brendan Whitney","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:18:10.216383-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-12T20:32:06.815904048Z","closed_at":"2026-02-12T20:32:06.815904048Z","close_reason":"Implemented ExecutionDecision, ExecutionStrategy, TaskInfo, GroupStrategy models with 33 tests","dependencies":[{"issue_id":"worktree-v2-34","depends_on_id":"worktree-v2-33","type":"blocked-by","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-34","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-34","depends_on_id":"worktree-v2-33","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-35","title":"RepoInfo analyzer for strategy decisions","description":"Implement RepoInfo that gathers context about the repository for strategy decisions.\n\n```python\n@dataclass\nclass RepoInfo:\n    has_dockerfile: bool\n    has_devcontainer: bool\n    has_env_file: bool\n    needs_auth: bool  # .npmrc, pip.conf, etc.\n    languages: list[str]\n    estimated_complexity: str  # simple, moderate, complex\n    \n    @classmethod\n    def from_path(cls, repo: Path) -\u003e 'RepoInfo': ...\n```\n\nDetection heuristics:\n- Dockerfile/docker-compose.yml → has_dockerfile\n- .devcontainer/ → has_devcontainer\n- .env, .env.example → has_env_file\n- .npmrc, pip.conf, ~/.gitconfig refs → needs_auth\n\nLocation: scripts/orchestrator/repo_info.py","status":"closed","priority":1,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:18:14.072225-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-12T20:32:06.923098756Z","closed_at":"2026-02-12T20:32:06.923098756Z","close_reason":"Implemented RepoInfo.from_path() with detection for dockerfile, devcontainer, env, auth, languages, complexity with 23 tests","dependencies":[{"issue_id":"worktree-v2-35","depends_on_id":"worktree-v2-33","type":"blocked-by","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-35","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-35","depends_on_id":"worktree-v2-33","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-36","title":"Mode decision logic (interactive vs autonomous)","description":"Implement the decision logic for choosing interactive vs autonomous mode.\n\nFactors favoring INTERACTIVE:\n- Tasks touch infrastructure (terraform, k8s, cloud APIs)\n- Tasks involve destructive operations (delete, reset, force push)\n- Total estimated complexity exceeds threshold\n- User explicitly requests oversight\n- First run on a new repo (build trust)\n\nFactors favoring AUTONOMOUS:\n- Tasks are well-scoped (specific files, clear acceptance criteria)\n- No destructive operations detected\n- Repo has good test coverage (safety net)\n- Previous successful runs on this repo\n\nCLI override: `--mode interactive` or `--mode autonomous`\n\nLocation: scripts/orchestrator/strategy.py (within ExecutionStrategy)","status":"closed","priority":1,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:18:18.570641-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-12T20:32:07.051235881Z","closed_at":"2026-02-12T20:32:07.051235881Z","close_reason":"Mode decision logic implemented in ExecutionStrategy._decide_mode() - destructive ops and complexity scoring","dependencies":[{"issue_id":"worktree-v2-36","depends_on_id":"worktree-v2-34","type":"blocked-by","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-36","depends_on_id":"worktree-v2-35","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-36","depends_on_id":"worktree-v2-33","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-37","title":"Target decision logic (local vs container vs sandbox)","description":"Implement the decision logic for choosing execution target.\n\nLOCAL:\n- Simple projects without special requirements\n- Fast iteration, no Docker overhead\n- Risk: pollutes host environment\n\nCONTAINER:\n- Reproducible environment needed\n- Project has Dockerfile\n- Ephemeral, clean slate each run\n\nSANDBOX:\n- Needs persistent auth (gh, npm, pip)\n- Long-running or resumable work\n- Multiple runs on same repo\n- Docker Desktop sandbox feature\n\nDecision flow:\n1. needs_auth or has_secrets → SANDBOX\n2. has_dockerfile or has_devcontainer → CONTAINER\n3. else → LOCAL\n\nCLI override: `--target local|container|sandbox`\n\nLocation: scripts/orchestrator/strategy.py (within ExecutionStrategy)","status":"closed","priority":1,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:18:22.49248-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-12T20:32:07.16560309Z","closed_at":"2026-02-12T20:32:07.16560309Z","close_reason":"Target decision logic implemented in ExecutionStrategy._decide_target() - auth→sandbox, docker→container, else→local","dependencies":[{"issue_id":"worktree-v2-37","depends_on_id":"worktree-v2-34","type":"blocked-by","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-37","depends_on_id":"worktree-v2-35","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-37","depends_on_id":"worktree-v2-33","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-38","title":"Parallelism and task grouping logic","description":"Implement logic to determine parallelism level and how to group tasks.\n\nGrouping strategies:\n- BY_STORY: Group tasks by user story label (spec-kit compatible)\n- BY_PHASE: Group by phase (setup, core, polish)\n- BY_INDEPENDENCE: Find maximal independent sets\n- SINGLE: One task per agent (maximum parallelism)\n\nParallelism limits:\n- Max agents = min(independent_groups, MAX_PARALLEL_AGENTS)\n- Consider resource constraints (CPU, memory, API rate limits)\n- User override: `--parallelism N`\n\n```python\ndef group_tasks(self, tasks: list[Task], strategy: GroupStrategy) -\u003e list[list[Task]]:\n    '''Return task groups, each group can run as one agent.'''\n    ...\n\ndef find_independent_groups(self, tasks: list[Task]) -\u003e list[list[Task]]:\n    '''Find tasks with no dependencies between them.'''\n    ...\n```\n\nLocation: scripts/orchestrator/strategy.py","status":"closed","priority":1,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:18:27.753432-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-12T20:32:07.259333757Z","closed_at":"2026-02-12T20:32:07.259333757Z","close_reason":"Parallelism and task grouping via union-find algorithm in ExecutionStrategy._group_tasks()","dependencies":[{"issue_id":"worktree-v2-38","depends_on_id":"worktree-v2-34","type":"blocked-by","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-38","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-38","depends_on_id":"worktree-v2-33","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-39","title":"CLI --explain flag for strategy preview","description":"Add --explain flag to show what the orchestrator would do without executing.\n\nOutput format:\n```\n$ worktree run --from beads --explain\n\nTask source: beads (12 tasks, 4 ready)\nRepository: /path/to/repo\n  - has_dockerfile: yes\n  - needs_auth: yes (found .npmrc)\n\nDecision: autonomous + sandbox + parallelism=3\n\nReasoning:\n  - No destructive operations detected → autonomous\n  - Repo has Dockerfile + needs auth → sandbox\n  - 3 independent task groups found → parallelism=3\n\nWould spawn:\n  Agent 1 (ralph-auth): worktree-v2-28, worktree-v2-29\n  Agent 2 (ralph-api): worktree-v2-30, worktree-v2-31\n  Agent 3 (ralph-ui): worktree-v2-32\n\nUse --confirm to proceed.\n```\n\nLocation: scripts/cli/worktree.py","status":"open","priority":2,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:18:33.369822-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-11T10:18:33.369822-07:00","dependencies":[{"issue_id":"worktree-v2-39","depends_on_id":"worktree-v2-36","type":"blocked-by","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-39","depends_on_id":"worktree-v2-37","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-39","depends_on_id":"worktree-v2-38","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-39","depends_on_id":"worktree-v2-33","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-40","title":"Epic: Multi-Agent Orchestration","description":"Implement the orchestration layer that spawns, monitors, and coordinates multiple agents working in parallel.\n\n## Design Decisions\n- Orchestrator spawns agents based on ExecutionStrategy decisions\n- Monitors agent completion and spawns newly-unblocked work\n- Handles agent failures with retry/skip/abort options\n- Reports overall progress and completion status\n\n## Key Capabilities\n- Spawn N agents in parallel for independent task groups\n- Monitor running agents (poll or event-based)\n- On agent completion: update beads, check for newly-unblocked tasks, spawn more\n- On agent failure: log, optionally retry, continue with others\n- Final report: PRs created, tasks completed, failures\n\n## References\n- Design conversation: worktree-v2 as the parallel execution layer","status":"open","priority":2,"issue_type":"epic","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:18:41.411557-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-11T10:18:41.411557-07:00","labels":["phase:orchestration"],"dependencies":[{"issue_id":"worktree-v2-40","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-41","title":"Agent spawn and monitoring loop","description":"Implement the main orchestration loop that manages multiple agents.\n\n```python\nclass Orchestrator:\n    async def run(self, decision: ExecutionDecision) -\u003e OrchestratorResult:\n        running: dict[str, AgentHandle] = {}\n        \n        # Initial spawn\n        for group in decision.task_groups:\n            if len(running) \u003c decision.parallelism:\n                handle = await self.spawn_agent(group)\n                running[handle.id] = handle\n        \n        # Monitor loop\n        while running or self.has_pending_tasks():\n            completed = await self.wait_for_any(running.values())\n            for handle in completed:\n                await self.handle_completion(handle)\n                del running[handle.id]\n            \n            # Spawn more if capacity and work available\n            newly_ready = self.task_source.get_ready_tasks()\n            ...\n        \n        return self.summarize()\n```\n\nLocation: scripts/orchestrator/orchestrator.py","status":"open","priority":2,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:18:49.609894-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-11T10:18:49.609894-07:00","dependencies":[{"issue_id":"worktree-v2-41","depends_on_id":"worktree-v2-40","type":"blocked-by","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-41","depends_on_id":"worktree-v2-32","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-41","depends_on_id":"worktree-v2-38","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-41","depends_on_id":"worktree-v2-40","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-42","title":"Agent completion handling and status sync","description":"Handle agent completion: update task status, create PRs, spawn follow-up work.\n\nOn agent success:\n1. Mark tasks as completed in TaskSource (bead close, checkbox toggle)\n2. Create PR if branch has commits\n3. Check for newly-unblocked tasks\n4. Log completion summary\n\nOn agent failure:\n1. Mark tasks as failed (or leave in-progress)\n2. Log error details\n3. Decision: retry, skip, or abort orchestration\n4. Continue with other agents if not aborting\n\nLocation: scripts/orchestrator/orchestrator.py","status":"open","priority":2,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:18:53.154869-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-11T10:18:53.154869-07:00","dependencies":[{"issue_id":"worktree-v2-42","depends_on_id":"worktree-v2-41","type":"blocked-by","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-42","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-42","depends_on_id":"worktree-v2-40","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-43","title":"Orchestrator progress reporting","description":"Implement progress reporting for the orchestration run.\n\nDuring run:\n- Show active agents and their current tasks\n- Show completed/failed/pending counts\n- Estimate time remaining (optional)\n\nOn completion:\n```\nOrchestration complete!\n\nSummary:\n  - Tasks completed: 12/15\n  - Tasks failed: 1 (worktree-v2-45: auth timeout)\n  - Tasks skipped: 2 (blocked by failed task)\n  \nAgents spawned: 5\nTotal time: 23m 45s\n\nPRs created:\n  - #123: Implement auth endpoints (worktree-v2-28, worktree-v2-29)\n  - #124: Add API routes (worktree-v2-30, worktree-v2-31)\n  - #125: Update UI components (worktree-v2-32)\n\nFailed tasks need attention:\n  - worktree-v2-45: See logs at .ralph/agents/ralph-auth/error.log\n```\n\nLocation: scripts/orchestrator/reporter.py","status":"open","priority":2,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:18:58.927664-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-11T10:18:58.927664-07:00","dependencies":[{"issue_id":"worktree-v2-43","depends_on_id":"worktree-v2-41","type":"blocked-by","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-43","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"worktree-v2-43","depends_on_id":"worktree-v2-40","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-44","title":"Design doc: Architecture and integration points","description":"Document the architectural decisions from the spec-kit analysis conversation.\n\nKey sections:\n1. **Separation of Concerns**\n   - Planning layer (spec-kit, searchlight, manual) - generates tasks\n   - State layer (beads) - tracks task status across sessions\n   - Execution layer (worktree-v2) - spawns and manages agents\n\n2. **Task Source Abstraction**\n   - Protocol-based design for multiple input formats\n   - Auto-detection with explicit override\n   - Beads as first-class citizen\n\n3. **Execution Strategy**\n   - Decision factors (complexity, risk, repo requirements)\n   - Mode: interactive vs autonomous\n   - Target: local vs container vs sandbox\n   - Parallelism and task grouping\n\n4. **Integration Points**\n   - How spec-kit + beads + worktree-v2 compose\n   - Potential beads extension for spec-kit\n   - Wrapper scripts for unified experience\n\nLocation: plugins/worktree-v2/docs/ARCHITECTURE.md","status":"open","priority":1,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:19:07.925838-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-11T10:19:07.925838-07:00","dependencies":[{"issue_id":"worktree-v2-44","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-45","title":"Rename project from worktree-v2 to superintendent","description":"Rename and refactor the project from worktree-v2 to superintendent.\n\n## Background\nDesign discussion determined that 'worktree-v2' no longer reflects the project scope. The tool is now an agent orchestration system that:\n- Accepts tasks from multiple sources (beads, markdown, spec-kit)\n- Makes execution strategy decisions (mode, target, parallelism)\n- Spawns and monitors parallel agents\n- Git worktrees are just one implementation detail\n\n'Superintendent' captures the supervisory role: assigning workers to jobs, choosing equipment, monitoring progress.\n\n## Tasks\n1. Restructure as standalone CLI (not Claude plugin):\n   - Move from plugins/worktree-v2/ to root or src/superintendent/\n   - Update pyproject.toml: name='superintendent-cli', entry point='superintendent' and 'sup'\n   \n2. Update Python package:\n   - Rename package imports\n   - Update all internal references\n   \n3. Update documentation:\n   - CLAUDE.md\n   - docs/WORKTREE_V2_DESIGN.md → docs/ARCHITECTURE.md\n   - Update README\n   \n4. Update CLI commands:\n   - Primary command: superintendent (or sup)\n   - Subcommands: run, spawn, status, list, cleanup\n\n5. Consider beads prefix:\n   - Existing beads keep worktree-v2-* prefix (history)\n   - New beads use sup-* prefix\n\n## Acceptance Criteria\n- [ ] `sup --help` works\n- [ ] All tests pass\n- [ ] No references to 'worktree' in code (except git worktree operations)\n- [ ] Documentation reflects new name and scope","status":"closed","priority":0,"issue_type":"task","assignee":"Brendan Whitney","owner":"brendan.whitney@faraday.io","created_at":"2026-02-11T10:43:39.831544-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-12T13:17:40.0502-07:00","closed_at":"2026-02-12T13:17:40.0502-07:00","close_reason":"Closed","labels":["phase:foundation"]}
{"id":"worktree-v2-4v1","title":"Epic: CLI \u0026 Commands","status":"closed","priority":3,"issue_type":"epic","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:48:47.633067-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T22:19:36.386130375Z","closed_at":"2026-02-09T22:19:36.386130375Z","close_reason":"All 4 tasks complete: ralph.py CLI, spawn.py CLI, slash commands, resume/cleanup. 110 new tests, all 384 passing.","dependencies":[{"issue_id":"worktree-v2-4v1","depends_on_id":"worktree-v2-8h9","type":"blocks","created_at":"2026-02-07T16:54:32.05772-07:00","created_by":"Brendan Whitney"},{"issue_id":"worktree-v2-4v1","depends_on_id":"worktree-v2-9qs","type":"blocks","created_at":"2026-02-07T16:54:32.785879-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-4v1.1","title":"ralph.py CLI with all flags","description":"CLI entry point with flags: --repo, --task, --branch, --context-file, --dry-run, --force, --sandbox-name. Parse args, call Planner, run Executor.","status":"closed","priority":0,"issue_type":"task","assignee":"Brendan Whitney","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:27.541679-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T22:13:08.24343119Z","closed_at":"2026-02-09T22:13:08.24343119Z","close_reason":"ralph.py CLI implemented with all flags, 30 tests passing","dependencies":[{"issue_id":"worktree-v2-4v1.1","depends_on_id":"worktree-v2-4v1","type":"parent-child","created_at":"2026-02-07T16:49:27.542383-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-4v1.2","title":"spawn.py CLI (simpler, no Docker)","description":"Simpler CLI that uses --dangerously-skip-permissions instead of Docker sandbox. For local development without sandbox overhead.","status":"closed","priority":0,"issue_type":"task","assignee":"Brendan Whitney","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:29.374851-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T22:14:33.240518564Z","closed_at":"2026-02-09T22:14:33.240518564Z","close_reason":"spawn.py CLI implemented with local mode, 24 tests passing","dependencies":[{"issue_id":"worktree-v2-4v1.2","depends_on_id":"worktree-v2-4v1","type":"parent-child","created_at":"2026-02-07T16:49:29.375641-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-4v1.3","title":"Slash command .md files","description":"Create command markdown files: spawn.md, ralph.md, list.md, resume.md, cleanup.md. Each invokes appropriate CLI with $ARGUMENTS.","status":"closed","priority":0,"issue_type":"task","assignee":"Brendan Whitney","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:31.283964-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T22:15:55.35251152Z","closed_at":"2026-02-09T22:15:55.35251152Z","close_reason":"5 slash command .md files created with 21 tests passing","dependencies":[{"issue_id":"worktree-v2-4v1.3","depends_on_id":"worktree-v2-4v1","type":"parent-child","created_at":"2026-02-07T16:49:31.284723-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-4v1.4","title":"Resume and cleanup commands","description":"resume.py: reattach to existing worktree/sandbox. cleanup.py: remove merged worktrees, stale sandboxes, registry entries.","status":"closed","priority":0,"issue_type":"task","assignee":"Brendan Whitney","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:32.822696-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T22:19:31.42911604Z","closed_at":"2026-02-09T22:19:31.42911604Z","close_reason":"resume.py and cleanup.py implemented with 35 tests passing","dependencies":[{"issue_id":"worktree-v2-4v1.4","depends_on_id":"worktree-v2-4v1","type":"parent-child","created_at":"2026-02-07T16:49:32.823768-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-8h9","title":"Epic: Backends","status":"closed","priority":1,"issue_type":"epic","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:48:46.526462-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T20:26:37.871632981Z","closed_at":"2026-02-09T20:26:37.871632981Z","close_reason":"All backend tasks complete: Docker, Git, Terminal, Factory, and Auth backends implemented with full test coverage.","dependencies":[{"issue_id":"worktree-v2-8h9","depends_on_id":"worktree-v2-9e1","type":"blocks","created_at":"2026-02-07T16:54:33.918474-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-8h9.1","title":"DockerBackend (Real, Mock, DryRun)","description":"Create DockerBackend protocol with: sandbox_exists(), create_sandbox(), start_sandbox(), exec_in_sandbox(), run_agent(). Implement RealDockerBackend, MockDockerBackend, DryRunDockerBackend.","status":"closed","priority":0,"issue_type":"task","assignee":"Brendan Whitney","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:09.525746-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T19:58:16.477934612Z","closed_at":"2026-02-09T19:58:16.477934612Z","close_reason":"Implemented in PR #2: DockerBackend protocol + Real/Mock/DryRun, 32 tests (2 integration)","dependencies":[{"issue_id":"worktree-v2-8h9.1","depends_on_id":"worktree-v2-8h9","type":"parent-child","created_at":"2026-02-07T16:49:09.526412-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-8h9.2","title":"GitBackend (Real, Mock, DryRun)","description":"Create GitBackend protocol with: clone(), create_worktree(), fetch(), checkout(), ensure_local(). Implement RealGitBackend, MockGitBackend, DryRunGitBackend.","status":"closed","priority":0,"issue_type":"task","assignee":"Brendan Whitney","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:10.956419-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T19:58:17.622736863Z","closed_at":"2026-02-09T19:58:17.622736863Z","close_reason":"Implemented in PR #2: GitBackend protocol + Real/Mock/DryRun, ensure_local with filesystem search, 54 tests","dependencies":[{"issue_id":"worktree-v2-8h9.2","depends_on_id":"worktree-v2-8h9","type":"parent-child","created_at":"2026-02-07T16:49:10.957218-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-8h9.3","title":"TerminalBackend (Real, Mock, DryRun)","description":"Create TerminalBackend protocol with: spawn(), wait(), is_running(). Implement RealTerminalBackend, MockTerminalBackend, DryRunTerminalBackend. Handle iTerm, Terminal.app, WezTerm.","status":"closed","priority":0,"issue_type":"task","assignee":"Brendan Whitney","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:12.517904-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T19:58:19.219361489Z","closed_at":"2026-02-09T19:58:19.219361489Z","close_reason":"Implemented in PR #2: TerminalBackend protocol + Real/Mock/DryRun, 22 tests","dependencies":[{"issue_id":"worktree-v2-8h9.3","depends_on_id":"worktree-v2-8h9","type":"parent-child","created_at":"2026-02-07T16:49:12.518628-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-8h9.4","title":"Backend factory and dependency injection","description":"Create BackendFactory that constructs appropriate backends based on mode (real, mock, dryrun). Wire into Executor constructor for clean dependency injection.","status":"closed","priority":0,"issue_type":"task","assignee":"Brendan Whitney","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:14.477258-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T19:58:20.127365406Z","closed_at":"2026-02-09T19:58:20.127365406Z","close_reason":"Implemented in PR #2: BackendMode enum, Backends container, create_backends factory, 9 tests","dependencies":[{"issue_id":"worktree-v2-8h9.4","depends_on_id":"worktree-v2-8h9","type":"parent-child","created_at":"2026-02-07T16:49:14.477997-07:00","created_by":"Brendan Whitney"},{"issue_id":"worktree-v2-8h9.4","depends_on_id":"worktree-v2-8h9.1","type":"blocks","created_at":"2026-02-07T16:54:44.326156-07:00","created_by":"Brendan Whitney"},{"issue_id":"worktree-v2-8h9.4","depends_on_id":"worktree-v2-8h9.2","type":"blocks","created_at":"2026-02-07T16:54:45.066466-07:00","created_by":"Brendan Whitney"},{"issue_id":"worktree-v2-8h9.4","depends_on_id":"worktree-v2-8h9.3","type":"blocks","created_at":"2026-02-07T16:54:45.711598-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-8h9.5","title":"AuthBackend (Real, Mock, DryRun)","description":"Create AuthBackend protocol with Real, Mock, and DryRun implementations.\n\n## Why this was missed\n\nThe Backends epic (PR #2) implemented Docker, Git, Terminal, and Factory backends but skipped AuthBackend. The authenticate step already exists in the Planner (planner.py:102-112) and Executor (executor.py:43 maps \"authenticate\" to AUTHENTICATING state), but there is no backend to actually perform the auth operations. Without this, the executor StepHandler has no concrete auth implementation to call.\n\n## Protocol methods\n\nAuthBackend should abstract these operations:\n- setup_git_auth(sandbox_name: str) -\u003e bool -- run gh auth setup-git inside sandbox\n- inject_token(sandbox_name: str, token: str) -\u003e bool -- write/mount GH_TOKEN into sandbox\n- validate_token(token: str, required_scopes: list[str]) -\u003e bool -- check token has needed scopes before starting agent\n- setup_ssh_key(sandbox_name: str, key_path: Path) -\u003e bool -- configure SSH key if using SSH instead of HTTPS\n\n## Implementation notes\n\n- RealAuthBackend will use DockerBackend.exec_in_sandbox() under the hood to run commands in the container -- it depends on DockerBackend being available\n- MockAuthBackend should record calls and support fail_on injection (same pattern as other mocks)\n- DryRunAuthBackend should log the commands that would be run\n- The factory (factory.py) needs to be updated to include auth in the Backends container\n- Follow the same Protocol pattern as Docker/Git/Terminal: @runtime_checkable, no __future__ annotations, quoted forward references only\n\n## Auth injection points in the workflow\n\n1. Planner creates authenticate step with params: {sandbox_name: ...} (planner.py:103-111)\n2. Executor maps \"authenticate\" action to AUTHENTICATING state (executor.py:43)\n3. The StepHandler.execute() receives this step -- needs a concrete handler that calls AuthBackend\n\n## Key consideration\n\nAuthBackend has a dependency on DockerBackend (needs exec_in_sandbox to run auth commands inside the container). This is an inter-backend dependency -- consider whether AuthBackend should take a DockerBackend in its constructor, or whether the StepHandler should mediate between them.\n\n## Acceptance criteria\n\n- [ ] AuthBackend protocol defined with @runtime_checkable\n- [ ] RealAuthBackend, MockAuthBackend, DryRunAuthBackend all satisfy protocol (isinstance checks)\n- [ ] MockAuthBackend records calls and supports fail_on\n- [ ] DryRunAuthBackend logs commands\n- [ ] Backends dataclass in factory.py updated to include auth field\n- [ ] create_backends() produces the correct auth backend for each mode\n- [ ] Tests in test_auth_backend.py covering all three implementations\n- [ ] Do NOT use from __future__ import annotations (FA100 is in ruff ignore)\n\n## Files to create/modify\n\n- Create: plugins/worktree-v2/scripts/backends/auth.py\n- Create: plugins/worktree-v2/scripts/tests/test_auth_backend.py\n- Modify: plugins/worktree-v2/scripts/backends/factory.py (add auth to Backends + create_backends)\n- Modify: plugins/worktree-v2/scripts/backends/__init__.py (export AuthBackend)","status":"closed","priority":2,"issue_type":"task","assignee":"Brendan Whitney","owner":"brendan.whitney@faraday.io","created_at":"2026-02-09T19:59:04.871935385Z","created_by":"Brendan Whitney","updated_at":"2026-02-09T20:26:32.180685936Z","closed_at":"2026-02-09T20:26:32.180685936Z","close_reason":"Implemented AuthBackend protocol with Real, Mock, DryRun implementations. 27 tests, lint/format clean.","dependencies":[{"issue_id":"worktree-v2-8h9.5","depends_on_id":"worktree-v2-8h9","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-9e1","title":"Epic: Core Architecture","status":"closed","priority":0,"issue_type":"epic","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:48:43.255689-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T19:58:10.486705568Z","closed_at":"2026-02-09T19:58:10.486705568Z","close_reason":"All 4 core tasks complete in PR #1: models, planner, executor, state machine"}
{"id":"worktree-v2-9e1.1","title":"Implement WorkflowStep and WorkflowPlan models","description":"Create dataclasses for WorkflowStep and WorkflowPlan in `scripts/orchestrator/models.py`.\n\n## Acceptance Criteria\n\n- [ ] `WorkflowStep` dataclass: `id`, `action`, `params`, `depends_on`\n- [ ] `WorkflowPlan` dataclass: `steps`, `metadata`, internal `_step_by_id` registry\n- [ ] `get_step(id)` returns step or None\n- [ ] `execution_order()` returns topologically sorted steps\n- [ ] `validate()` returns list of errors (empty if valid)\n- [ ] `to_json()` / `from_json()` round-trip works\n- [ ] Validation catches: missing deps, duplicate IDs, cycles\n- [ ] Tests in `tests/test_models.py`, all pass\n\n## Files\n\n- Create: `plugins/worktree-v2/scripts/orchestrator/__init__.py`\n- Create: `plugins/worktree-v2/scripts/orchestrator/models.py`\n- Create: `plugins/worktree-v2/scripts/tests/__init__.py`\n- Create: `plugins/worktree-v2/scripts/tests/test_models.py`\n\n## Verify\n\n```bash\nuv run --with pytest pytest plugins/worktree-v2/scripts/tests/test_models.py -v\n```","status":"closed","priority":0,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:48:57.957293-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T19:57:58.472941145Z","closed_at":"2026-02-09T19:57:58.472941145Z","close_reason":"Implemented in PR #1: WorkflowStep, WorkflowPlan with validation, topo sort, JSON round-trip","dependencies":[{"issue_id":"worktree-v2-9e1.1","depends_on_id":"worktree-v2-9e1","type":"parent-child","created_at":"2026-02-07T16:48:57.958112-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-9e1.2","title":"Implement Planner (creates workflow from inputs)","description":"Create Planner class that takes repo, task, mode and produces a WorkflowPlan with ordered steps: validate_repo, create_worktree, prepare_sandbox, authenticate, initialize_state, start_agent.","status":"closed","priority":0,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:00.260141-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T19:57:59.780087313Z","closed_at":"2026-02-09T19:57:59.780087313Z","close_reason":"Implemented in PR #1: Planner creates sandbox/local plans with correct step ordering","dependencies":[{"issue_id":"worktree-v2-9e1.2","depends_on_id":"worktree-v2-9e1","type":"parent-child","created_at":"2026-02-07T16:49:00.260802-07:00","created_by":"Brendan Whitney"},{"issue_id":"worktree-v2-9e1.2","depends_on_id":"worktree-v2-9e1.1","type":"blocks","created_at":"2026-02-07T16:54:41.316433-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-9e1.3","title":"Implement Executor (runs steps, manages state)","description":"Create Executor that takes a WorkflowPlan and backends, runs each step through appropriate backend, saves checkpoints for resume, handles errors with rollback logic.","status":"closed","priority":0,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:02.543397-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T19:58:05.729880982Z","closed_at":"2026-02-09T19:58:05.729880982Z","close_reason":"Implemented in PR #1: Executor with state transitions, checkpoints, error handling","dependencies":[{"issue_id":"worktree-v2-9e1.3","depends_on_id":"worktree-v2-9e1.4","type":"blocks","created_at":"2026-02-07T16:54:43.427321-07:00","created_by":"Brendan Whitney"},{"issue_id":"worktree-v2-9e1.3","depends_on_id":"worktree-v2-9e1","type":"parent-child","created_at":"2026-02-07T16:49:02.544153-07:00","created_by":"Brendan Whitney"},{"issue_id":"worktree-v2-9e1.3","depends_on_id":"worktree-v2-9e1.1","type":"blocks","created_at":"2026-02-07T16:54:42.005032-07:00","created_by":"Brendan Whitney"},{"issue_id":"worktree-v2-9e1.3","depends_on_id":"worktree-v2-9e1.2","type":"blocks","created_at":"2026-02-07T16:54:42.744999-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-9e1.4","title":"Implement state machine with transitions","description":"Create WorkflowState enum: INIT → ENSURING_REPO → CREATING_WORKTREE → PREPARING_SANDBOX → AUTHENTICATING → INITIALIZING_STATE → STARTING_AGENT → AGENT_RUNNING → COMPLETED | FAILED. Include valid_transition() checks.","status":"closed","priority":0,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:04.212548-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T19:58:02.020888939Z","closed_at":"2026-02-09T19:58:02.020888939Z","close_reason":"Implemented in PR #1: WorkflowState enum with valid_transition, next_state, is_terminal","dependencies":[{"issue_id":"worktree-v2-9e1.4","depends_on_id":"worktree-v2-9e1","type":"parent-child","created_at":"2026-02-07T16:49:04.21321-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-9qs","title":"Epic: State Management","status":"closed","priority":2,"issue_type":"epic","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:48:47.137937-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T21:07:24.618389241Z","closed_at":"2026-02-09T21:07:24.618389241Z","close_reason":"All 3 tasks complete: checkpoint/resume, ralph state, global registry. 58 new tests, 277 total passing.","dependencies":[{"issue_id":"worktree-v2-9qs","depends_on_id":"worktree-v2-9e1","type":"blocks","created_at":"2026-02-07T16:54:34.787548-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-9qs.1","title":"Workflow checkpoint/resume","description":"Save workflow state to .ralph/workflow_state.json: workflow_id, current_state, completed_steps, sandbox_name, worktree_path, timestamps. Enable resume from checkpoint.","status":"closed","priority":0,"issue_type":"task","assignee":"Brendan Whitney","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:18.960355-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T21:03:45.889115303Z","closed_at":"2026-02-09T21:03:45.889115303Z","close_reason":"Implemented WorkflowCheckpoint dataclass with save/load/exists functions. 15 tests covering creation, serialization, file I/O, update, and edge cases.","dependencies":[{"issue_id":"worktree-v2-9qs.1","depends_on_id":"worktree-v2-9qs","type":"parent-child","created_at":"2026-02-07T16:49:18.961168-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-9qs.2","title":"Ralph state (.ralph/ directory)","description":"Manage .ralph/ directory: progress.md, config.json, guardrails.md, worktree-task.md. Include reset_ralph_state() for sandbox reuse.","status":"closed","priority":0,"issue_type":"task","assignee":"Brendan Whitney","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:21.226121-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T21:04:56.86488292Z","closed_at":"2026-02-09T21:04:56.86488292Z","close_reason":"Implemented .ralph/ directory management with init, reset, config save/load, progress updates, and RalphState wrapper class. 22 tests.","dependencies":[{"issue_id":"worktree-v2-9qs.2","depends_on_id":"worktree-v2-9qs","type":"parent-child","created_at":"2026-02-07T16:49:21.226824-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-9qs.3","title":"Global worktree registry","description":"Track all active worktrees in ~/.claude/worktree-registry.json. Include list, add, remove, cleanup operations.","status":"closed","priority":0,"issue_type":"task","assignee":"Brendan Whitney","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:22.594761-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-09T21:06:33.485269717Z","closed_at":"2026-02-09T21:06:33.485269717Z","close_reason":"Implemented WorktreeRegistry with WorktreeEntry dataclass. Operations: list, get, add, remove, cleanup. 21 tests.","dependencies":[{"issue_id":"worktree-v2-9qs.3","depends_on_id":"worktree-v2-9qs","type":"parent-child","created_at":"2026-02-07T16:49:22.595471-07:00","created_by":"Brendan Whitney"}]}
{"id":"worktree-v2-cg0","title":"Epic: Documentation \u0026 Polish","status":"open","priority":4,"issue_type":"epic","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:48:51.970464-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-07T16:48:51.970464-07:00","labels":["phase:polish"],"dependencies":[{"issue_id":"worktree-v2-cg0","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-cg0.1","title":"CLAUDE.md with project context","description":"Update CLAUDE.md as project context for AI agents.\n\n**Sections:**\n1. Quick Reference - common commands\n2. Project Overview - what this does\n3. Architecture - CLI → Planner → Executor → Backends\n4. Directory Structure - what's where\n5. Development Guidelines - TDD, patterns\n6. Key Files - most important files\n\nAcceptance criteria:\n- [ ] All sections present and accurate\n- [ ] Commands are copy-pasteable\n- [ ] New contributors can onboard quickly","status":"open","priority":4,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:46.36686-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-11T16:25:05.837108-07:00","dependencies":[{"issue_id":"worktree-v2-cg0.1","depends_on_id":"worktree-v2-cg0","type":"parent-child","created_at":"2026-02-07T16:49:46.367661-07:00","created_by":"Brendan Whitney"},{"issue_id":"worktree-v2-cg0.1","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-cg0.2","title":"README with usage examples","description":"Create README.md for end users.\n\n**Sections:**\n1. Overview - what worktree-v2 does\n2. Installation - prerequisites, setup\n3. Quick Start - spawn first agent\n4. CLI Reference - all commands with examples\n5. Modes and Targets - when to use each\n6. Troubleshooting - common issues\n\nAcceptance criteria:\n- [ ] Enables first-time use without other docs\n- [ ] All CLI commands documented\n- [ ] Troubleshooting covers common issues","status":"open","priority":4,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:47.719192-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-11T16:25:05.936812-07:00","dependencies":[{"issue_id":"worktree-v2-cg0.2","depends_on_id":"worktree-v2-cg0","type":"parent-child","created_at":"2026-02-07T16:49:47.719891-07:00","created_by":"Brendan Whitney"},{"issue_id":"worktree-v2-cg0.2","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-cg0.3","title":"Inline code documentation","description":"Add docstrings to public functions and classes.\n\n**Guidelines:**\n- Focus on WHY, not WHAT\n- Keep minimal - one line if possible\n- Document non-obvious behavior, side effects\n- Use Google-style docstrings\n- Skip obvious getters/setters\n\n**Priority:**\n1. Backend protocols\n2. Orchestrator (planner, executor)\n3. State management\n4. CLI entry points\n\nAcceptance criteria:\n- [ ] All Protocol classes documented\n- [ ] All public functions have docstrings\n- [ ] Docstrings explain WHY not WHAT","status":"open","priority":4,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:49.382665-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-11T16:25:06.037695-07:00","dependencies":[{"issue_id":"worktree-v2-cg0.3","depends_on_id":"worktree-v2-cg0","type":"parent-child","created_at":"2026-02-07T16:49:49.383406-07:00","created_by":"Brendan Whitney"},{"issue_id":"worktree-v2-cg0.3","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-ext","title":"Epic: Testing","status":"open","priority":3,"issue_type":"epic","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:48:48.190382-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-11T16:25:04.458594-07:00","labels":["phase:polish"],"dependencies":[{"issue_id":"worktree-v2-ext","depends_on_id":"worktree-v2-9e1","type":"blocks","created_at":"2026-02-07T16:54:35.222206-07:00","created_by":"Brendan Whitney"},{"issue_id":"worktree-v2-ext","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-ext.1","title":"Unit tests for planner/executor","description":"Fast unit tests for planner and executor with no external dependencies.\n\n**Location:** scripts/tests/test_planner.py, scripts/tests/test_executor.py\n\n**Planner tests:**\n- test_planner_creates_clone_step_for_new_worktree()\n- test_planner_creates_sandbox_steps_when_target_sandbox()\n- test_planner_skips_docker_for_local_target()\n- test_planner_includes_auth_step_when_token_provided()\n\n**Executor tests:**\n- test_executor_runs_steps_in_order()\n- test_executor_handles_step_failure_gracefully()\n- test_executor_saves_checkpoint_after_each_step()\n- test_executor_can_resume_from_checkpoint()\n\n**Requirements:**\n- Use MockBackends for all backend operations\n- No file I/O to real filesystem (use tmp_path)\n- No subprocess calls\n- Tests should run in \u003c1 second total\n\nAcceptance criteria:\n- [ ] Planner tests cover step generation\n- [ ] Executor tests cover execution flow\n- [ ] All tests use MockBackends\n- [ ] Tests run fast (\u003c1s)","status":"open","priority":3,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:36.81147-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-11T16:25:04.558607-07:00","dependencies":[{"issue_id":"worktree-v2-ext.1","depends_on_id":"worktree-v2-ext","type":"parent-child","created_at":"2026-02-07T16:49:36.812088-07:00","created_by":"Brendan Whitney"},{"issue_id":"worktree-v2-ext.1","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-ext.2","title":"Integration tests with mock backends","description":"Integration tests running full workflows with mocked backends.\n\n**Location:** scripts/tests/test_integration.py\n\n**Test scenarios:**\n- test_full_sandbox_workflow_happy_path()\n- test_full_local_workflow_happy_path()\n- test_workflow_recovers_from_git_failure()\n- test_checkpoint_persists_across_executor_instances()\n\n**What to verify:**\n- Planner → Executor → Backends integration\n- State transitions follow WorkflowState enum\n- Checkpoints save/load correctly\n- Error recovery doesn't leave partial state\n\n**Requirements:**\n- Use MockBackends configured to simulate real behavior\n- Can use real filesystem (tmp_path) for state files\n- No real Docker or git subprocess calls\n\nAcceptance criteria:\n- [ ] Full workflow scenarios covered\n- [ ] State transitions tested\n- [ ] Checkpoint persistence verified\n- [ ] Error recovery paths tested","status":"open","priority":3,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:38.339981-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-11T16:25:04.661426-07:00","dependencies":[{"issue_id":"worktree-v2-ext.2","depends_on_id":"worktree-v2-ext","type":"parent-child","created_at":"2026-02-07T16:49:38.340599-07:00","created_by":"Brendan Whitney"},{"issue_id":"worktree-v2-ext.2","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-ext.3","title":"E2E test script","description":"End-to-end tests with real Docker operations.\n\n**Location:** scripts/tests/test_e2e.py\n**Marker:** @pytest.mark.e2e (skipped in normal runs)\n\n**Test scenarios:**\n- test_e2e_sandbox_created_and_agent_starts()\n- test_e2e_sandbox_reuse_preserves_state()\n- test_e2e_cleanup_removes_sandbox()\n\n**Requirements:**\n- Requires Docker installed and running\n- Use @pytest.mark.e2e decorator\n- CI runs these in separate job with Docker\n- Tests must clean up after themselves\n\nAcceptance criteria:\n- [ ] E2E scenarios with real Docker\n- [ ] All tests marked @pytest.mark.e2e\n- [ ] CI job configured for e2e tests\n- [ ] Tests clean up containers","status":"open","priority":3,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:40.211844-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-11T16:25:04.762372-07:00","dependencies":[{"issue_id":"worktree-v2-ext.3","depends_on_id":"worktree-v2-ext","type":"parent-child","created_at":"2026-02-07T16:49:40.212426-07:00","created_by":"Brendan Whitney"},{"issue_id":"worktree-v2-ext.3","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"worktree-v2-ext.4","title":"Dry-run verification tests","description":"Tests verifying --dry-run output shows correct commands.\n\n**Location:** scripts/tests/test_dryrun.py\n\n**Test scenarios:**\n- test_dryrun_shows_git_clone_command()\n- test_dryrun_shows_docker_sandbox_create()\n- test_dryrun_shows_all_steps_in_order()\n\n**What to verify:**\n- DryRunDockerBackend prints exact docker commands\n- DryRunGitBackend prints exact git commands\n- Commands include real values (paths, branch names)\n- Output order matches execution order\n\nAcceptance criteria:\n- [ ] All DryRun backends have output tests\n- [ ] Commands verified syntactically correct\n- [ ] Variable substitution verified","status":"open","priority":3,"issue_type":"task","owner":"brendan.whitney@faraday.io","created_at":"2026-02-07T16:49:42.322936-07:00","created_by":"Brendan Whitney","updated_at":"2026-02-11T16:25:04.861778-07:00","dependencies":[{"issue_id":"worktree-v2-ext.4","depends_on_id":"worktree-v2-ext","type":"parent-child","created_at":"2026-02-07T16:49:42.32359-07:00","created_by":"Brendan Whitney"},{"issue_id":"worktree-v2-ext.4","depends_on_id":"worktree-v2-45","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
